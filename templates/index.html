{% extends 'base.html' %}
{% block content %}

<!-- Carrousel SOMAM -->
<div id="somamCarousel" class="carousel slide shadow-lg rounded-3 overflow-hidden mb-5" data-bs-ride="carousel">

  <!-- Indicateurs -->
  <div class="carousel-indicators">
    <button type="button" data-bs-target="#somamCarousel" data-bs-slide-to="0" class="active"></button>
    <button type="button" data-bs-target="#somamCarousel" data-bs-slide-to="1"></button>
    <button type="button" data-bs-target="#somamCarousel" data-bs-slide-to="2"></button>
    <button type="button" data-bs-target="#somamCarousel" data-bs-slide-to="3"></button>
  </div>

  <!-- Slides -->
  <div class="carousel-inner">

    <!-- Slide 1 -->
    <div class="carousel-item active">
      <img src="{{ url_for('static', filename='img/projets/le_rosier.jpg') }}" class="d-block w-100" style="object-fit:cover;height:500px;" alt="Résidence Le Rosier">
      <div class="carousel-caption d-none d-md-block bg-dark bg-opacity-50 rounded p-3">
        <h5>Résidence Le Rosier</h5>
        <p>Programme résidentiel moderne avec commerces et terrasses panoramiques.</p>
      </div>
    </div>

    <!-- Slide 2 -->
    <div class="carousel-item">
      <img src="{{ url_for('static', filename='img/projets/el_bahia.jpg') }}" class="d-block w-100" style="object-fit:cover;height:500px;" alt="Résidence El Bahia">
      <div class="carousel-caption d-none d-md-block bg-dark bg-opacity-50 rounded p-3">
        <h5>Résidence El Bahia</h5>
        <p>60 logements – espaces verts, parkings et performance thermique.</p>
      </div>
    </div>

    <!-- Slide 3 -->
    <div class="carousel-item">
      <img src="{{ url_for('static', filename='img/immobilier/villa1.jpg') }}" class="d-block w-100" style="object-fit:cover;height:500px;" alt="Villa contemporaine">
      <div class="carousel-caption d-none d-md-block bg-dark bg-opacity-50 rounded p-3">
        <h5>Villa contemporaine – Tichy</h5>
        <p>Suite parentale, grand séjour, jardin arboré de 300 m².</p>
      </div>
    </div>

    <!-- Slide 4 : autres projets.. -->
    <div class="carousel-item">
      <div class="d-flex align-items-center justify-content-center bg-body-tertiary" style="height:500px;">
        <div class="text-center px-5">
          <h1 class="display-5 fw-bold">Bâtiment & Immobilier à Béjaïa</h1>
          <p class="fs-5">SNC Bouanani & Cie SOMAM conçoit, construit et commercialise des projets durables en Algérie.</p>
          <a class="btn btn-primary btn-lg" href="{{ url_for('main.projects') }}">Voir nos projets</a>
        </div>
      </div>
    </div>

  </div>

  <!-- Contrôles -->
  <button class="carousel-control-prev" type="button" data-bs-target="#somamCarousel" data-bs-slide="prev">
    <span class="carousel-control-prev-icon"></span>
  </button>
  <button class="carousel-control-next" type="button" data-bs-target="#somamCarousel" data-bs-slide="next">
    <span class="carousel-control-next-icon"></span>
  </button>
</div>


<h2 class="mb-3">Derniers biens</h2>
<div class="row g-3">
  {% for b in properties %}
  <div class="col-md-4">
    <div class="card h-100">
      <img src="{{ b.image_url or url_for('static', filename='img/placeholder.jpg') }}" class="card-img-top" alt="bien">
      <div class="card-body">
        <h5 class="card-title">{{ b.title }}</h5>
        <p class="card-text small text-muted">{{ b.city }} · {{ b.surface }} m² · {{ b.rooms }} pièces</p>
        <p class="fw-semibold">{{ '{:,.0f}'.format(b.price).replace(',', ' ') }} DA</p>
        <a class="btn btn-outline-primary btn-sm" href="{{ url_for('main.property_detail', item_id=b.id) }}">Détails</a>
      </div>
    </div>
  </div>
  {% else %}
  <p>Aucun bien pour le moment.</p>
  {% endfor %}
</div>

<h2 class="mt-5 mb-3">Projets récents</h2>
<div class="row g-3">
  {% for p in projects %}
  <div class="col-md-4">
    <div class="card h-100">
      <img src="{{ p.image_url or url_for('static', filename='img/placeholder.jpg') }}" class="card-img-top" alt="projet">
      <div class="card-body">
        <h5 class="card-title">{{ p.name }}</h5>
        <p class="card-text small text-muted">Statut : {{ p.status }}</p>
        <p class="card-text">{{ p.description[:120] }}{% if p.description|length > 120 %}...{% endif %}</p>
      </div>
    </div>
  </div>
  {% else %}
  <p>Aucun projet pour le moment.</p>
  {% endfor %}
</div>
{% endblock %}
